<section class="indexing" data-ng-controller="indexing.Main.Controller as main">

    <main class="content-full">

        <div class="alert-editing" data-ng-show="isIndexing && main.currentEvent.id"><button class="btn-delete-event" data-ng-click="main.deleteCurrentEvent()"><i class="icon-remove"></i> Delete Event</button><h5>Click the variable you wish to edit.</h5></div>

        <x-krossover-videoplayer></x-krossover-videoplayer>

        <div class="indexing-block">

            <form name="formIndexing" role="form" novalidate>

                <span data-ng-if="isIndexing">

                    <!-- Tags -->
                    <div class="tags" data-ng-show="main.currentTags.length">

                        <button class="tag" data-ng-repeat="tag in main.currentTags" data-keybinding="{{ tag.shortcutKey.toLowerCase() }}" data-ng-click="main.selectTag(tag.id)" tabindex="{{ $index+1 }}">{{ tag.name }} ({{ tag.shortcutKey.toLowerCase() }})</button>

                    </div>

                    <!-- Script -->
                    <div class="script" data-ng-hide="main.currentTags.length">

                        <x-item item="item" event="main.currentEvent" data-ng-repeat="item in buildScript(main.currentEvent)"></x-item>

                    </div>

                </span>

                <div class="controls">

                    <!-- Start button -->
                    <button class="btn-indexing-start" data-ng-if="isReady && !isIndexing" data-ng-click="main.index()"><i class="icon-warning-sign"></i> Press <b>return</b> to start indexing</button>

                    <!-- State movement buttons -->
                    <button class="btn-back" data-ng-if="isIndexing" data-ng-click="main.back()">Back (Esc)</button>
                    <button class="btn-save" data-ng-if="isIndexing && !main.currentTags.length && main.savable()" data-ng-click="main.save()" data-ng-disabled="formIndexing.$invalid">Save Event (Return)</button>
                    <button class="btn-next" data-ng-if="isIndexing && !main.currentTags.length && !main.savable()" data-ng-click="main.next()" data-ng-disabled="formIndexing.$invalid">Next (Return)</button>

                </div>

            </form>

        </div>

    </main>

    <aside class="sidebar-notes" data-ui-toggle="sidebar.notes">

        <header>

            <h6>Notes</h6>
            <button class="btn-close" data-ng-click="sidebar.playlist = false"><i class="icon-remove"></i></button>

        </header>

        <div class="notes">

        </div>

    </aside>

    <aside class="sidebar-playlist" data-ui-toggle="sidebar.playlist">

        <header>

            <h6>Playlist</h6>
            <button class="btn-close" data-ng-click="sidebar.playlist = false"><i class="icon-remove"></i></button>

        </header>

        <div class="plays">

            <!-- Play -->
            <div class="play" data-ng-class="{ active: main.currentPlay.id === play.id }" data-ng-repeat="play in indexing.plays">

                <h4><span class="period">{{ indexing.league.periodAbbreviationLabel }} {{ indexing.period }}</span><span class="dash"> — </span><time>{{ play.startTime | time }}<span class="dash"> — </span>{{ play.endTime | time }}</time><span class="dash"> — </span><span class="team">{{ indexing.team.name }}</span> <span class="score">{{ play.teamScore }}</span><span class="vs"> vs </span><span class="score">{{ play.opposingScore }}</span> <span class="team">{{ indexing.opposingTeam.name }}</span></h4>

                <ul class="events">

                    <!-- Event -->
                    <li class="event" data-ng-repeat="event in play.events">

                        <button class="btn-select-event" data-ng-class="{ active: main.currentEvent.id === event.id }" data-ng-click="main.selectEvent(play, event)" data-ng-disabled="!isReady">

                            <x-item item="item" event="event" data-ng-repeat="item in buildScript(event)" data-ng-disabled="true"></x-item>

                        </button>

                    </li>

                </ul>

                <hr>

                <button class="btn-delete-play" data-ng-click="main.deletePlay(play)"><i class="icon-remove"></i> Delete Play</button>

            </div>

        </div>

    </aside>

</section>
