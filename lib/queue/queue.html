<section class="queue" data-ng-controller="QueueController">

    <aside class="sidebar" data-ng-init="sidebar = true" data-ui-toggle="sidebar">

        <h3>Search</h3>

        <form role="form">

            <div class="form-group">

                <select class="form-control" name="sport" data-ng-model="filter.sport">
                    <option value="">Pick a Sport</option>
                    <option data-ng-value="sport.id" data-ng-selected="sport.id === filter.sport" data-ng-repeat="sport in sports">{{sport.name}}</option>
                </select>

            </div>

            <div class="form-group">

                <select class="form-control" name="status" data-ng-model="filter.status">
                    <option value="">Status</option>
                    <option data-ng-value="status.id" data-ng-selected="status.id === filter.status" data-ng-repeat="status in GAME_STATUSES">{{status.name}}</option>
                </select>

            </div>

            <div class="form-group">

                <input class="form-control" name="id" placeholder="Game ID" data-ng-model="filter.gameId" type="search" autocomplete="on" list="queue-gameIds" autosave="queue-gameIds">
                <datalist id="queue-gameIds">
                    <option data-ng-repeat="games in queue | orderBy:'id'" value="{{game.id}}"></option>
                </datalist>

            </div>

            <div class="form-group">

                <input class="form-control" name="team" placeholder="Team Name" data-ng-model="filter.team" type="search" autocomplete="on" list="queue-teams" autosave="queue-teams">
                <datalist id="queue-teams">
                    <option data-ng-repeat="team in teams | unique:'name' | orderBy:'name'" value="{{team.name}}"></option>
                </datalist>

            </div>

            <div class="form-group">

                <input class="form-control" name="coach-firstname" placeholder="Coach First Name" data-ng-model="filter.coachFirstName" type="search" autocomplete="on" list="queue-coach-firstnames" autosave="queue-coach-firstnames">
                <datalist id="queue-coach-firstnames">
                    <option data-ng-repeat="coach in users | filter:ROLE_TYPE.COACH" value="{{coach.firstName}}"></option>
                </datalist>

            </div>

            <div class="form-group">

                <input class="form-control" name="coach-lastname" placeholder="Coach Last Name" data-ng-model="filter.coachLastName" type="search" autocomplete="on" list="queue-coach-lastnames" autosave="queue-coach-lastnames">
                <datalist id="queue-coach-lastnames">
                    <option data-ng-repeat="coach in users | filter:ROLE_TYPE.COACH | unique:'lastName' | orderBy:'lastName'" value="{{coach.lastName}}"></option>
                </datalist>

            </div>

            <div class="form-group">

                <input class="form-control" name="indexer-firstname" placeholder="Indexer First Name" data-ng-model="filter.indexerFirstName" type="search" autocomplete="on" list="queue-indexer-firstnames" autosave="queue-indexer-firstnames">
                <datalist id="queue-indexer-firstnames">
                    <option data-ng-repeat="indexer in users | filter:ROLE_TYPE.INDEXER | unique:'firstName' | orderBy:'firstName'" value="{{indexer.firstName}}"></option>
                </datalist>

            </div>

            <div class="form-group">

                <input class="form-control" name="indexer-lastname" placeholder="Indexer Last Name" data-ng-model="filter.indexerLastName" type="search" autocomplete="on" list="queue-indexer-lastnames" autosave="queue-indexer-lastnames">
                <datalist id="queue-indexer-lastnames">
                    <option data-ng-repeat="indexer in users | filter:ROLE_TYPE.INDEXER | unique:'lastName' | orderBy:'lastName'" value="{{indexer.lastName}}"></option>
                </datalist>

            </div>

            <div class="form-group">

                <input class="form-control" name="assurer-firstname" placeholder="QA First Name" data-ng-model="filter.qaFirstName" type="search" autocomplete="on" list="queue-assurer-firstnames" autosave="queue-assurer-firstnames">
                <datalist id="queue-assurer-firstnames">
                    <option data-ng-repeat="assurer in users | filter:ROLE_TYPE.INDEXER | unique:'firstName' | orderBy:'firstName'" value="{{assurer.firstName}}"></option>
                </datalist>

            </div>

            <div class="form-group">

                <input class="form-control" name="assurer-lastname" placeholder="QA Last Name" data-ng-model="filter.qaLastName" type="search" autocomplete="on" list="queue-assurer-lastnames" autosave="queue-assurer-lastnames">
                <datalist id="queue-assurer-lastnames">
                    <option data-ng-repeat="assurer in users | filter:ROLE_TYPE.INDEXER | unique:'lastName' | orderBy:'lastName'" value="{{assurer.lastName}}"></option>
                </datalist>

            </div>

        </form>

        <button class="btn-search" data-ng-show="sidebar" data-ng-click="search(filter)"><i class="icon-search"></i></button>
        <button class="btn-search" data-ng-hide="sidebar" data-ng-click="sidebar=!sidebar"><i class="icon-search"></i></button>

        <button class="btn-toggle-sidebar" data-ng-show="sidebar" data-ng-click="sidebar = false"><i class="icon-chevron-left"></i></button>
        <button class="btn-toggle-sidebar" data-ng-hide="sidebar" data-ng-click="sidebar = true"><i class="icon-chevron-right"></i></button>

    </aside>

    <div class="list" data-ng-hide="noResults">

        <div class="table-responsive">

            <table class="table table-striped table-hover">

                <tbody>

                    <tr data-ng-repeat="game in queue | filter:{ id: filter.gameId }">

                        <td>{{sports[leagues[teams[game.teamId].leagueId].sportId].name}}</td>
                        <td>{{ game.id }}</td>
                        <td><a data-ui-sref="game-info({ id: game.id })">{{ teams[game.teamId].name }} vs<br>{{ teams[game.opposingTeamId].name }}</a></td>
                        <td>{{ users[teams[game.teamId].getHeadCoachRole().userId].lastName }}</td>
                        <td>{{ GAME_STATUSES[GAME_STATUS_IDS[game.status]].name }}</td>

                        <td>

                            <button class="btn btn-link" data-ng-if="game.canBeAssignedToIndexer()" data-ng-click="assign('indexer', game.id)">Assign</button>

                            <ul data-ng-if="game.hasIndexerAssignment()" data-ng-repeat="assignment in game.indexerAssignments.slice().reverse() | filter:{ isQa: false } | limitTo:1">

                                <li>{{ users[assignment.userId].firstName }} {{ users[assignment.userId].lastName }}</li>

                            </ul>

                        </td>

                        <td>

                            <button class="btn btn-link" data-ng-if="game.canBeAssignedToQa()" data-ng-click="assign('assurer', game.id)">Assign</button>

                            <ul data-ng-if="game.hasQaAssignment()" data-ng-repeat="assignment in game.indexerAssignments.slice().reverse() | filter:{ isQa: true } | limitTo:1">

                                <li>{{ users[assignment.userId].firstName }} {{ users[assignment.userId].lastName }}</li>

                            </ul>

                        </td>

                    </tr>

                </tbody>

            </table>

        </div>

    </div>

    <div class="noresults" data-ng-show="noResults">

        <i class="icon-search"></i>
        <h1>No Results Found</h1>
        <h2>Try your search again.</h2>

    </div>

</section>

